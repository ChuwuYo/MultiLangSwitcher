## ⚠️ 需要注意的问题与建议

### 1. **domain-rules.json 配置可同步化**

目前 `domain-rules.json` 与 `domain-rules-manager.js` 手动维护，建议：

- 在 `background.js` 启动阶段动态 load JSON，避免配置冗余。
    
- 可引入版本控制结构，让扩展自动检测 JSON 更新并热加载规则。

---

### 2. **i18n 实现方式建议优化**

当前 i18n 通过 `i18n/` 目录 JSON +页面直接引用：

- 建议统一封装一个通用 `translate(key)` 函数，避免在多个文件中重复 `getLocale()`, `messages[key]`。

---

### 3. **错误/异常日志统一**

各方式中 `console.error(...)` 分散，建议封装日志器：

或发送到 `debug-ui.js` 统一展示。

---

### 4. **后台服务工作者初始化逻辑复杂**

`chrome.runtime.onInstalled` 监听器中的初始化逻辑处理了多种场景（自动切换、现有语言设置、首次安装），但缺乏统一的错误恢复机制。

### 5. **自定义语言验证不足**

调试界面的自定义语言输入只做了非空检查，缺乏 Accept-Language 格式的严格验证。

### 6. **快速检查功能的错误处理**

弹窗的快速检查功能依赖多个外部 API，但错误处理机制可能导致用户体验不佳。

## 📌 总结建议

| 项目 | 建议优化 |
| --- | --- |
| **domain 配置** | 启动时自动 sync JSON & 规则 |
| **i18n** | 封装 `translate()` 简化多处代码 |
| **日志处理** | 统一 logger + UI 展示机制 |
| **后台初始化** | 优化逻辑，添加错误恢复机制 |
| **语言验证** | 增加格式验证，提高输入准确性 |
| **错误处理** | 改进 API 错误处理，提升用户体验 |

---

## 📝 后续计划

- 实现动态配置加载机制
- 添加配置版本控制和热更新功能
- 统一配置文件格式和访问接口
- 创建统一的 `translate()` 函数
- 简化多文件中的国际化调用
- 优化语言包加载机制
- 封装统一的日志记录器
- 集中日志展示和过滤功能
- 改进错误追踪和诊断能力
- 添加更严格的输入验证
- 改进网络请求的重试机制
- 优化用户错误提示体验
