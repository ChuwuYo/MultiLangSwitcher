<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>MultiLangSwitcher Debug Page</title>
  <link href="bootstrap.min.css" rel="stylesheet">
  <link href="typefaces/MapleMonoNL-Regular.woff2" rel="stylesheet">
  <link href="theme-switcher.css" rel="stylesheet">
  <style>
    body {
      padding: 20px;
    }
    .debug-section {
      margin-bottom: 20px;
      padding: 15px;
      border-radius: 5px;
      background-color: #f8f9fa;
    }
    .debug-result {
      margin-top: 10px;
      padding: 10px;
      border-radius: 5px;
      background-color: #fff;
      border: 1px solid #dee2e6;
      max-height: 300px;
      overflow-y: auto;
      word-break: break-all; /* Èò≤Ê≠¢ÈïøË°åÊ∫¢Âá∫ */
      white-space: pre-wrap; /* ‰øùÁïôÁ©∫ÁôΩÁ¨¶Âπ∂Êç¢Ë°å */
      font-size: 0.9em; /* Ë∞ÉÊï¥Â≠ó‰ΩìÂ§ßÂ∞è‰ª•ÈÄÇÂ∫îÊõ¥Â§öÂÜÖÂÆπ */
    }
    .success {
      color: green;
      font-weight: bold;
    }
    .error {
      color: rgb(240, 101, 101);
      font-weight: bold;
    }
    /* Êó•Âøó‰∏çÂêåÁ±ªÂûãÁöÑÈ¢úËâ≤ */
    .log-info { color: rgb(165, 165, 250); }
    .log-warning { color: orange; }
    .log-error { color: rgb(248, 115, 115); }
    .log-success { color: green; }

    @font-face { font-family: 'MapleMonoNL'; src: url('typefaces/MapleMonoNL-Regular.woff2') format('woff2'); }
    body { font-family: 'MapleMonoNL', sans-serif; }

    /* ÂåπÈÖçËßÑÂàôËØ¶ÊÉÖÁöÑÊ†∑Âºè */
    .matched-rule-detail {
        margin-left: 15px;
        border-left: 2px solid #007bff;
        padding-left: 10px;
        margin-bottom: 5px;
    }
  </style>
</head>
<body>
  <button id="themeToggleBtn" class="theme-toggle" title="Toggle Theme">üåô</button>
  <div class="container">
    <h2>MultiLangSwitcher Debug Tools</h2>
    <p class="lead">This page helps you diagnose and solve language preference issues</p>

    <div class="alert alert-info">
      <strong>Tip:</strong> If your request headers cannot be successfully changed, you can use this page for diagnosis. After opening this page, operations in other parts of the extension (such as the popup page) will display logs here.
    </div>

    <div class="row">
      <div class="col-md-6">
        <div class="debug-section">
          <h4>Current Rules Information</h4>
          <p class="text-muted">Shows the dynamic rules currently in effect by the extension and details of recently matched rules.</p>
          <button id="showRulesBtn" class="btn btn-primary">Show Current Rules</button>
          <div id="rulesResult" class="debug-result">Click the button to view current rules...</div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="debug-section">
          <h4>Request Header Test</h4>
          <p class="text-muted">Send a request to the test address to check if the Accept-Language header is set as expected.</p>
          <div class="mb-3">
            <label for="testLanguage" class="form-label">Test Language:</label>
            <select class="form-select" id="testLanguage">
              <option value="zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá (zh-CN)</option>
              <option value="zh-TW">ÁπÅ‰Ωì‰∏≠Êñá (zh-TW)</option>
              <option value="zh-HK">ÁπÅ‰Ωì‰∏≠Êñá (È¶ôÊ∏Ø) (zh-HK)</option>
              <option value="en-US">English (US) (en-US)</option>
              <option value="en-GB">English (UK) (en-GB)</option>
              <option value="en-AU">English (Australia) (en-AU)</option>
              <option value="en-CA">English (Canada) (en-CA)</option>
              <option value="ja">Êó•Êú¨Ë™û (ja)</option>
              <option value="ko">ÌïúÍµ≠Ïñ¥ (ko)</option>
              <option value="fr">Fran√ßais (fr)</option>
              <option value="fr-CA">Fran√ßais (Canada) (fr-CA)</option>
              <option value="de">Deutsch (de)</option>
              <option value="de-AT">Deutsch (√ñsterreich) (de-AT)</option>
              <option value="de-CH">Deutsch (Schweiz) (de-CH)</option>
              <option value="es">Espa√±ol (es)</option>
              <option value="es-MX">Espa√±ol (M√©xico) (es-MX)</option>
              <option value="es-AR">Espa√±ol (Argentina) (es-AR)</option>
              <option value="ru">–†—É—Å—Å–∫–∏–π (ru)</option>
              <option value="pt-BR">Portugu√™s (Brasil) (pt-BR)</option>
              <option value="pt-PT">Portugu√™s (Portugal) (pt-PT)</option>
              <option value="it">Italiano (it)</option>
              <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (ar)</option>
              <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (hi)</option>
              <option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ (bn)</option>
              <option value="ur">ÿßÿ±ÿØŸà (ur)</option>
              <option value="fa">ŸÅÿßÿ±ÿ≥€å (fa)</option>
              <option value="tr">T√ºrk√ße (tr)</option>
              <option value="nl">Nederlands (nl)</option>
              <option value="nl-BE">Nederlands (Belgi√´) (nl-BE)</option>
              <option value="pl">Polski (pl)</option>
              <option value="sv">Svenska (sv)</option>
              <option value="fi">Suomi (fi)</option>
              <option value="da">Dansk (da)</option>
              <option value="no">Norsk (no)</option>
              <option value="cs">ƒåe≈°tina (cs)</option>
              <option value="sk">Slovenƒçina (sk)</option>
              <option value="hu">Magyar (hu)</option>
              <option value="ro">Rom√¢nƒÉ (ro)</option>
              <option value="bg">–ë—ä–ª–≥–∞—Ä—Å–∫–∏ (bg)</option>
              <option value="hr">Hrvatski (hr)</option>
              <option value="sr">–°—Ä–ø—Å–∫–∏ (sr)</option>
              <option value="sl">Sloven≈°ƒçina (sl)</option>
              <option value="et">Eesti (et)</option>
              <option value="lv">Latvie≈°u (lv)</option>
              <option value="lt">Lietuvi≈≥ (lt)</option>
              <option value="el">ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨ (el)</option>
              <option value="he">◊¢◊ë◊®◊ô◊™ (he)</option>
              <option value="th">‡πÑ‡∏ó‡∏¢ (th)</option>
              <option value="vi">Ti·∫øng Vi·ªát (vi)</option>
              <option value="id">Bahasa Indonesia (id)</option>
              <option value="ms">Bahasa Melayu (ms)</option>
              <option value="tl">Filipino (tl)</option>
              <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ (uk)</option>
              <option value="be">–ë–µ–ª–∞—Ä—É—Å–∫–∞—è (be)</option>
              <option value="ka">·É•·Éê·É†·Éó·É£·Éö·Éò (ka)</option>
              <option value="hy">’Ä’°’µ’•÷Ä’•’∂ (hy)</option>
              <option value="az">Az…ôrbaycan (az)</option>
              <option value="kk">“ö–∞–∑–∞“õ—à–∞ (kk)</option>
              <option value="ky">–ö—ã—Ä–≥—ã–∑—á–∞ (ky)</option>
              <option value="uz">O'zbek (uz)</option>
              <option value="mn">–ú–æ–Ω–≥–æ–ª (mn)</option>
              <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç (ta)</option>
            </select>
          </div>
          <button id="testHeaderBtn" class="btn btn-success">Test Request Header</button>
          <div id="headerTestResult" class="debug-result">Click the button to test request header...</div>
        </div>
      </div>

      <!-- Êñ∞Â¢ûÔºöËá™ÂÆö‰πâËØ≠Ë®ÄËÆæÁΩÆ -->
      <div class="col-md-6">
        <div class="debug-section">
          <h4>Custom Language Preference</h4>
          <p class="text-muted">Enter a complete Accept-Language string, such as "en-US,en;q=0.9,fr;q=0.8".</p>
          <div class="mb-3">
            <label for="customLanguageInput" class="form-label">Custom Language String:</label>
            <input type="text" class="form-control" id="customLanguageInput" placeholder="Example: en-US,en;q=0.9,fr;q=0.8">
          </div>
          <button id="applyCustomLangBtn" class="btn btn-primary">Apply Custom Language</button>
          <div id="customLangResult" class="debug-result mt-2"></div>
        </div>
      </div>
      <!-- Ëá™ÂÆö‰πâËØ≠Ë®ÄËÆæÁΩÆÁªìÊùü -->

      <!-- Accept-Language Ê†ºÂºèËØ¥ÊòéÂç°Áâá -->
      <div class="col-md-6">
        <div class="debug-section">
          <h4>Accept-Language Format Explanation</h4>
          <p class="text-muted">Understand the structure of the Accept-Language request header.</p>
          <p><strong>Basic Format:</strong></p>
          <ul>
            <li><code>Language code</code> (required): e.g. <code>en</code> (English), <code>zh</code> (Chinese). Uses ISO 639-1 standard.</li>
            <li><code>-Region code</code> (optional): e.g. <code>US</code> (United States), <code>CN</code> (Mainland China), <code>HK</code> (Hong Kong). Uses ISO 3166-1 Alpha 2 standard.</li>
            <li><code>;q=Quality value</code> (optional): Range 0 to 1, indicates priority, default is 1.</li>
          </ul>
          <p><strong>Examples:</strong></p>
          <ul>
            <li><code>en-US</code>: American English</li>
            <li><code>zh-CN</code>: Simplified Chinese (Mainland China)</li>
            <li><code>fr</code>: French (no region specified)</li>
            <li><code>en-US,en;q=0.9,zh-CN;q=0.8</code>: Priority American English, followed by general English, then Simplified Chinese.</li>
          </ul>
          <p class="small text-muted">Please follow this format in the input box above to set custom language.</p>
        </div>
      </div>
      <!-- Accept-Language Ê†ºÂºèËØ¥ÊòéÂç°ÁâáÁªìÊùü -->
    </div>

    <div class="debug-section mt-4">
      <h4>Live Logs</h4>
       <p class="text-muted">Shows log messages sent by the extension at runtime to help track issues.</p>
      <div class="mb-3">
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" id="filterInfo" value="info" checked>
          <label class="form-check-label" for="filterInfo">Info</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" id="filterWarning" value="warning" checked>
          <label class="form-check-label" for="filterWarning">Warning</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" id="filterError" value="error" checked>
          <label class="form-check-label" for="filterError">Error</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" id="filterSuccess" value="success" checked>
          <label class="form-check-label" for="filterSuccess">Success</label>
        </div>
      </div>
      <div id="logOutput" class="debug-result"></div>
      <button id="clearLogsBtn" class="btn btn-secondary btn-sm mt-2">Clear Logs</button>
    </div>

    <div class="debug-section mt-4">
      <h4>Common Problem Fixes</h4>
      <p class="text-muted">Try to automatically fix some common configuration issues.</p>
      <div class="list-group">
        <button id="fixPriorityBtn" class="list-group-item list-group-item-action">
          <strong>Fix Rule Priority</strong> - Increase dynamic rule priority to 100 to override static rules
        </button>
        <button id="clearAllRulesBtn" class="list-group-item list-group-item-action">
          <strong>Clear and Reapply Rules</strong> - Delete all dynamic rules and recreate with current settings
        </button>
      </div>
      <div id="fixResult" class="debug-result mt-3">Select a fix option...</div>
    </div>

    <div class="debug-section mt-4">
      <h4>Extension Diagnostic Information</h4>
      <p class="text-muted">Shows basic information, permissions, and configuration of the extension.</p>
      <button id="showDiagnosticsBtn" class="btn btn-info">Show Diagnostic Information</button>
      <div id="diagnosticsResult" class="debug-result">Click the button to view diagnostic information...</div>
    </div>

    <!-- Ëá™Âä®ÂàáÊç¢ÂäüËÉΩÊéßÂà∂ -->
    <div class="debug-section mt-4">
      <h4>Auto Switch Feature</h4>
      <p class="text-muted">Control the feature to automatically switch language by domain. (May detect incorrectly)</p>
      <div class="form-check form-switch mb-3">
        <input class="form-check-input" type="checkbox" id="autoSwitchToggle">
        <label class="form-check-label" for="autoSwitchToggle">Enable Auto Switch (by domain)</label>
      </div>
      <button id="showDomainRulesBtn" class="btn btn-outline-primary">Show Domain Mapping Rules</button>
      <div id="domainRulesResult" class="debug-result">Click the button to view domain mapping rules...</div>
    </div>
    <!-- Ëá™Âä®ÂàáÊç¢ÂäüËÉΩÊéßÂà∂ÁªìÊùü -->
  </div>

  <script src="debug-i18n.js"></script>
  <script src="debug-headers.js"></script>
  <script src="debug-ui.js"></script>
  <script src="theme-switcher.js"></script>
</body>
</html>